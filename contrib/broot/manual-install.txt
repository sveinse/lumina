
To install xenial-root:
-----------------------

- Install root

    $ sudo qemu-debootstrap --arch=armhf --variant=minbase xenial xenial-root

- Update apt

    xenial-root/etc/apt/sources.list

    deb http://ports.ubuntu.com/ubuntu-ports xenial main universe multiverse restricted
    deb http://ports.ubuntu.com/ubuntu-ports xenial-updates main universe multiverse restricted
    deb http://ports.ubuntu.com/ubuntu-ports xenial-security main universe multiverse restricted
    deb http://ports.ubuntu.com/ubuntu-ports xenial-backports main universe multiverse restricted

- Comment out the preloader (for rpi)

    $ sudo nano rpi-root/etc/ld.so.preloader

- Run target chroot

    $ sudo ./chrun xenial-root

- Ensure no local mods to system can be made (on target)

     for fn in \
         /usr/sbin/invoke-rc.d \
         /sbin/start \
         /sbin/poweroff \
         /sbin/reboot \
         /sbin/initctl \
         /sbin/telinit \
         ; do \
            dpkg-divert --add --local --divert ${fn}.install --rename ${fn}; \
            cp /bin/true ${fn}; \
     done

- Update system

    # export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    # export DEBIAN_FRONTEND=noninteractive
    # apt update
    # apt dist-upgrade

- Setup local users

    # addgroup --gid 1000 build
    # adduser --uid 1000 --gid 1000 --shell /bin/bash --gecos "Build User" --disabled-password build

- Get compilation tools

    # apt install build-essential

- Become user when doing compilation

    # su - build     *or*    su - pi
    $ sudo ./chroot xenial-root -- su - build
